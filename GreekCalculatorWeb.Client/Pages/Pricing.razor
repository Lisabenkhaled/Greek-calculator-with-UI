@page "/pricing"
@inject HttpClient Http

<h2 class="text-4xl font-bold mb-6 text-center">üìà Pricing</h2>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6">

    <!-- LEFT CARD -->
    <div class="p-6 rounded-2xl shadow-lg bg-gradient-to-br from-white to-purple-50 border border-purple-200">
        <h3 class="text-xl font-semibold mb-4 text-purple-700">Option Data</h3>

        <div class="space-y-3">

            <input @bind="model.Ticker" placeholder="Ticker (AAPL)" class="input" />
            <input @bind="model.Spot" type="number" placeholder="Spot price" class="input" />
            <input @bind="model.Strike" type="number" placeholder="Strike K" class="input" />
            <input @bind="model.Vol" type="number" placeholder="Volatility œÉ (0.2)" class="input" />
            <input @bind="model.Rate" type="number" placeholder="Risk-free rate r (0.03)" class="input" />
            <input @bind="model.DividendYield" type="number" placeholder="Dividend q (0)" class="input" />
            <input @bind="model.Maturity" type="number" placeholder="Maturity T (years)" class="input" />

            <select @bind="model.OptionType" class="input">
                <option value="0">Call</option>
                <option value="1">Put</option>
            </select>

            <select @bind="model.OptionStyle" class="input">
                <option value="0">European</option>
                <option value="1">American</option>
            </select>

            <select @bind="model.PricingMethod" class="input">
                <option value="0">Black-Scholes</option>
                <option value="1">Binomial</option>
                <option value="2">Monte Carlo</option>
                <option value="3">LSM Monte Carlo</option>
            </select>

        </div>

        <button class="btn-primary mt-4 w-full" @onclick="Calculate">
            ‚ñ∂ Compute Price
        </button>
    </div>

    <!-- RIGHT CARD -->
    <div class="p-6 rounded-2xl shadow-lg bg-gradient-to-br from-white to-blue-50 border border-blue-200">
        <h3 class="text-xl font-semibold mb-4 text-blue-700">R√©sultat</h3>

        @if (PriceResult is not null)
        {
            <p class="text-3xl font-bold text-blue-600">üí∞ @PriceResult EUR</p>
        }
        else
        {
            <p class="text-gray-400 text-lg">Aucun r√©sultat pour le moment.</p>
        }
    </div>
</div>

@code {

    PricingRequest model = new();
    double? PriceResult = null;

    public async Task Calculate()
    {
        var response = await Http.PostAsJsonAsync("api/pricing", model);

        if (response.IsSuccessStatusCode)
        {
            PriceResult = await response.Content.ReadFromJsonAsync<double>();
        }
        else
        {
            Console.WriteLine("‚ùå HTTP Error: " + response.StatusCode);
        }
    }
}
