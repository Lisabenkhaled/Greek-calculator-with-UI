@page "/pricing"
@inject HttpClient Http

<h2 class="text-3xl font-bold mb-6">Pricing</h2>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="p-6 bg-white rounded-xl shadow">
        <h3 class="text-xl font-semibold mb-4">Option Data</h3>

        <div class="space-y-3">

            <input @bind="Ticker" placeholder="Ticker (AAPL)" class="input" />
            <input @bind="Spot" placeholder="Spot" class="input" />
            <input @bind="Strike" placeholder="Strike" class="input" />
            <input @bind="Vol" placeholder="Vol (0.2)" class="input" />
            <input @bind="Rate" placeholder="Rate (0.03)" class="input" />
            <input @bind="Maturity" placeholder="Maturity (years)" class="input" />

            <select @bind="Method" class="input">
                <option value="0">Black-Scholes</option>
                <option value="1">Monte Carlo</option>
                <option value="2">Binomial</option>
            </select>
        </div>

        <button class="btn-primary mt-4" @onclick="Calculate">Calculate</button>
    </div>

    <div class="p-6 bg-white rounded-xl shadow">
        <h3 class="text-xl font-semibold mb-4">RÃ©sultat</h3>

        @if (PriceResult is not null)
        {
            <p class="text-2xl font-bold text-blue-600">ðŸ’° @PriceResult</p>
        }
        else
        {
            <p class="text-gray-400">Aucun rÃ©sultat.</p>
        }
    </div>
</div>

@code {

    string Ticker = "";
    double Spot, Strike, Vol, Rate, Maturity;
    int Method = 0;

    double? PriceResult;

    public async Task Calculate()
    {
        var req = new
        {
            Ticker,
            Spot,
            Strike,
            Vol,
            Rate,
            Maturity,
            Method
        };

        PriceResult = await Http.PostAsJsonAsync("api/pricing", req)
                                  .Result.Content.ReadFromJsonAsync<double>();
    }
}
